<VirtualHost *:443>
        SSLEngine On
        SSLProxyEngine On

        SSLCertificateFile {{ssl_cert}}
	{% if ssl_chain %}
        SSLCertificateChainFile {{ssl_chain}}
	{% endif %}
        SSLCertificateKeyFile {{ssl_key}}

        ServerName {{server_name}}

        SSLProtocol -ALL +TLSv1 +TLSv1.1 +TLSv1.2
        SSLHonorCipherOrder on
        SSLUseStapling On
        
	Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"

        SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK

 	{% if server_admin %}
	ServerAdmin {{server_admin}}
	{% endif %}
        
	DocumentRoot "{{document_root}}"

	ServerName {{server_name}}

	{% if proxy_backend %}
	ProxyRequests Off
	ProxyVia Off
       	<Proxy *>
        	Order deny,allow
        	Allow from all
       </Proxy>

	ProxyPreserveHost On
	<Location />
		ProxyPass {{proxy_backend}}/ retry=5
		ProxyPassReverse {{proxy_backend}}/

		Order deny,allow
		Allow from all
	</Location>
	{% endif %}
</VirtualHost>
